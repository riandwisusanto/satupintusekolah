import{a,b as e,l,f as s,y as t,m as n,h as u,g as r,t as c,i as d,c as i,F as o,s as v,u as p,n as m,p as g,o as h}from"./vue-CzxLGHcz.js";import{_,S as b,h as f,a as j,b as y}from"./app-BZL2lnh6.js";import{F as k,E as x}from"./ExportButtons-8hI5iNqq.js";const w={class:"content"},T={class:"container-fluid"},V={class:"row mt-3"},S={class:"col-md-6"},E={class:"col-md-6"},G={key:0,class:"row mt-4"},M={class:"col-lg-3 col-6"},O={class:"small-box bg-info"},q={class:"inner"},F={class:"col-lg-3 col-6"},J={class:"small-box bg-success"},C={class:"inner"},K={class:"col-lg-3 col-6"},P={class:"small-box bg-warning"},D={class:"inner"},I={class:"col-lg-3 col-6"},L={class:"small-box bg-danger"},U={class:"inner"},N={class:"row mt-4"},Y={class:"col-12"},A={class:"card card-outline card-navy shadow-sm"},B={class:"card-header"},R={class:"card-tools"},z={class:"card-body table-responsive p-0"},H={key:0,class:"text-center p-5"},Q={key:1,class:"table table-hover ledger-table text-nowrap"},W={class:"text-center"},X={class:"badge badge-info"},Z={key:2,class:"text-center p-5"},$={class:"text-muted"},aa={key:0,class:"card-footer clearfix"},ea={class:"pagination pagination-sm m-0 float-right"},la=["onClick"],sa=_({__name:"teacher-journals",setup(_){const sa=a(!1),ta=a([]),na=a({total_journals:0,unique_teachers:0,unique_classes:0,total_subjects:0}),ua=a({start_date:"",end_date:"",month:"",academic_year_id:"",teacher_id:"",subject_id:"",class_id:""}),ra=a({current_page:1,per_page:15,total:0,last_page:1}),ca=async(a=1)=>{sa.value=!0;try{const e={...ua.value,page:a,per_page:ra.value.per_page};Object.keys(e).forEach(a=>{e[a]||delete e[a]});const{ok:l,data:s,error:t}=await j("reports/teacher-journals",{method:"GET",params:e});l?(ta.value=s.data.journals.data||[],ra.value={current_page:s.data.journals.current_page,per_page:s.data.journals.per_page,total:s.data.journals.total,last_page:s.data.journals.last_page}):y(t)}catch(e){y(e.message)}finally{sa.value=!1}},da=async()=>{try{const a={...ua.value};Object.keys(a).forEach(e=>{a[e]||delete a[e]});const{ok:e,data:l,error:s}=await j("reports/teacher-journals/summary",{method:"GET",params:a});e&&(na.value=l.data.summary)}catch(a){}},ia=async()=>{ra.value.current_page=1,await Promise.all([ca(1),da()])},oa=()=>{ua.value={start_date:"",end_date:"",month:"",academic_year_id:"",teacher_id:"",subject_id:"",class_id:""},ta.value=[],na.value={total_journals:0,unique_teachers:0,unique_classes:0,total_subjects:0}},va=a=>{a>=1&&a<=ra.value.last_page&&ca(a)},pa=e(()=>ta.value.length>0),ma=e(()=>Object.keys(ua.value).filter(a=>ua.value[a]).length>0);return l(()=>{const a=new Date,e=new Date(a.getFullYear(),a.getMonth(),1),l=new Date(a.getFullYear(),a.getMonth()+1,0);ua.value.start_date=e.toISOString().split("T")[0],ua.value.end_date=l.toISOString().split("T")[0],ia()}),(a,e)=>(h(),s(o,null,[e[18]||(e[18]=t('<section class="content-header" data-v-1de4e175><div class="container-fluid" data-v-1de4e175><div class="row" data-v-1de4e175><div class="col-sm-6" data-v-1de4e175><h4 class="font-serif-formal" data-v-1de4e175>Laporan Jurnal Guru</h4></div><div class="col-sm-6" data-v-1de4e175><ol class="breadcrumb float-sm-right" data-v-1de4e175><li class="breadcrumb-item" data-v-1de4e175><a href="#" data-v-1de4e175>Laporan</a></li><li class="breadcrumb-item active" data-v-1de4e175>Jurnal Guru</li></ol></div></div></div></section>',1)),n("section",w,[n("div",T,[u(k,{modelValue:ua.value,"onUpdate:modelValue":e[0]||(e[0]=a=>ua.value=a),onApply:ia,onReset:oa},null,8,["modelValue"]),n("div",V,[n("div",S,[u(b,{modelValue:ua.value.subject_id,"onUpdate:modelValue":e[1]||(e[1]=a=>ua.value.subject_id=a),label:"Filter Mata Pelajaran (Opsional)",name:"subject_id",placeholder:"Semua Mata Pelajaran",serverside:!0,endpoint:"subjects","label-key":"name","value-key":"id"},null,8,["modelValue"])]),n("div",E,[u(b,{modelValue:ua.value.class_id,"onUpdate:modelValue":e[2]||(e[2]=a=>ua.value.class_id=a),label:"Filter Kelas (Opsional)",name:"class_id",placeholder:"Semua Kelas",serverside:!0,endpoint:"classrooms","label-key":"name","value-key":"id"},null,8,["modelValue"])])]),pa.value?(h(),s("div",G,[n("div",M,[n("div",O,[n("div",q,[n("h3",null,c(na.value.total_journals),1),e[5]||(e[5]=n("p",null,"Total Jurnal",-1))]),e[6]||(e[6]=n("div",{class:"icon"},[n("i",{class:"fas fa-book"})],-1))])]),n("div",F,[n("div",J,[n("div",C,[n("h3",null,c(na.value.unique_teachers),1),e[7]||(e[7]=n("p",null,"Jumlah Guru",-1))]),e[8]||(e[8]=n("div",{class:"icon"},[n("i",{class:"fas fa-chalkboard-teacher"})],-1))])]),n("div",K,[n("div",P,[n("div",D,[n("h3",null,c(na.value.unique_classes),1),e[9]||(e[9]=n("p",null,"Jumlah Kelas",-1))]),e[10]||(e[10]=n("div",{class:"icon"},[n("i",{class:"fas fa-school"})],-1))])]),n("div",I,[n("div",L,[n("div",U,[n("h3",null,c(na.value.total_subjects),1),e[11]||(e[11]=n("p",null,"Mata Pelajaran",-1))]),e[12]||(e[12]=n("div",{class:"icon"},[n("i",{class:"fas fa-book-open"})],-1))])])])):r("",!0),n("div",N,[n("div",Y,[n("div",A,[n("div",B,[e[13]||(e[13]=n("h3",{class:"card-title font-serif-formal"},[n("i",{class:"fas fa-table mr-2"}),d(" Data Jurnal Guru ")],-1)),n("div",R,[pa.value?(h(),i(x,{key:0,filters:ua.value,"report-type":"teacher-journals"},null,8,["filters"])):r("",!0)])]),n("div",z,[sa.value?(h(),s("div",H,[...e[14]||(e[14]=[n("i",{class:"fas fa-spinner fa-spin fa-3x text-navy"},null,-1),n("p",{class:"mt-3"},"Memuat data...",-1)])])):pa.value?(h(),s("table",Q,[e[16]||(e[16]=n("thead",null,[n("tr",null,[n("th",{style:{width:"5%"}},"No"),n("th",null,"Tanggal"),n("th",null,"Nama Guru"),n("th",null,"Kelas"),n("th",null,"Mata Pelajaran"),n("th",null,"Tema"),n("th",null,"Kegiatan"),n("th",null,"Catatan")])],-1)),n("tbody",null,[(h(!0),s(o,null,v(ta.value,(a,l)=>{var t,u,r;return h(),s("tr",{key:a.id},[n("td",W,c((ra.value.current_page-1)*ra.value.per_page+l+1),1),n("td",null,[e[15]||(e[15]=n("i",{class:"fas fa-calendar-day mr-1 text-muted"},null,-1)),d(" "+c(p(f)(a.date)),1)]),n("td",null,[n("strong",null,c((null==(t=a.teacher)?void 0:t.name)||"-"),1)]),n("td",null,c((null==(u=a.classroom)?void 0:u.name)||"-"),1),n("td",null,[n("span",X,c((r=a,r.subjects&&0!==r.subjects.length?r.subjects.map(a=>{var e;return(null==(e=a.subject)?void 0:e.name)||"-"}).join(", "):"-")),1)]),n("td",null,c(a.theme||"-"),1),n("td",null,c(a.activity||"-"),1),n("td",null,c(a.note||"-"),1)])}),128))])])):(h(),s("div",Z,[e[17]||(e[17]=n("i",{class:"fas fa-inbox fa-3x text-muted mb-3"},null,-1)),n("p",$,c(ma.value?"Tidak ada data untuk filter yang dipilih":'Silakan pilih filter dan klik "Tampilkan Laporan"'),1)]))]),pa.value&&ra.value.last_page>1?(h(),s("div",aa,[n("ul",ea,[n("li",{class:m(["page-item",{disabled:1===ra.value.current_page}])},[n("a",{class:"page-link",href:"#",onClick:e[3]||(e[3]=g(a=>va(ra.value.current_page-1),["prevent"]))},"«")],2),(h(!0),s(o,null,v(ra.value.last_page,a=>(h(),s("li",{key:a,class:m(["page-item",{active:ra.value.current_page===a}])},[n("a",{class:"page-link",href:"#",onClick:g(e=>va(a),["prevent"])},c(a),9,la)],2))),128)),n("li",{class:m(["page-item",{disabled:ra.value.current_page===ra.value.last_page}])},[n("a",{class:"page-link",href:"#",onClick:e[4]||(e[4]=g(a=>va(ra.value.current_page+1),["prevent"]))},"»")],2)])])):r("",!0)])])])])])],64))}},[["__scopeId","data-v-1de4e175"]]);export{sa as default};
