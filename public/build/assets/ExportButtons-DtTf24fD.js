import{b as a,a as e,f as l,o as t,m as s,i as r,g as o,n,F as d,q as c,v as i,h as u,t as p}from"./vue-CzxLGHcz.js";import{_ as m,S as b,b as v,e as f}from"./app-Bhqy4hvs.js";const y={class:"card card-outline card-navy shadow-sm"},h={class:"card-body"},g={class:"row"},_={class:"col-md-12 mb-3"},k={class:"btn-group btn-group-toggle w-100",role:"group"},x={class:"col-md-6"},w={class:"form-group"},T={class:"col-md-6"},F={class:"form-group"},U={key:1,class:"col-md-6"},j={class:"form-group"},E={key:2,class:"col-md-6"},V={key:3,class:"col-md-6"},L=m({__name:"FilterPanel",props:{modelValue:{type:Object,default:()=>({})},showTeacherFilter:{type:Boolean,default:!0},showAcademicYearFilter:{type:Boolean,default:!0}},emits:["update:modelValue","apply","reset"],setup(p,{emit:m}){const v=p,f=m,L=a({get:()=>v.modelValue,set:a=>f("update:modelValue",a)}),R=e("date_range"),S=()=>{f("apply",L.value)},P=()=>{L.value={start_date:"",end_date:"",month:"",academic_year_id:"",teacher_id:""},R.value="date_range",f("reset")};return(a,e)=>(t(),l("div",y,[e[17]||(e[17]=s("div",{class:"card-header"},[s("h3",{class:"card-title font-serif-formal"},[s("i",{class:"fas fa-filter mr-2"}),r(" Filter Laporan ")])],-1)),s("div",h,[s("div",g,[s("div",_,[e[11]||(e[11]=s("label",{class:"form-label"},"Tipe Filter Periode",-1)),s("div",k,[s("button",{type:"button",class:n(["btn","date_range"===R.value?"btn-navy":"btn-outline-secondary"]),onClick:e[0]||(e[0]=a=>R.value="date_range")},[...e[8]||(e[8]=[s("i",{class:"fas fa-calendar-alt mr-1"},null,-1),r(" Range Tanggal ",-1)])],2),s("button",{type:"button",class:n(["btn","month"===R.value?"btn-navy":"btn-outline-secondary"]),onClick:e[1]||(e[1]=a=>R.value="month")},[...e[9]||(e[9]=[s("i",{class:"fas fa-calendar mr-1"},null,-1),r(" Bulanan ",-1)])],2),p.showAcademicYearFilter?(t(),l("button",{key:0,type:"button",class:n(["btn","academic_year"===R.value?"btn-navy":"btn-outline-secondary"]),onClick:e[2]||(e[2]=a=>R.value="academic_year")},[...e[10]||(e[10]=[s("i",{class:"fas fa-graduation-cap mr-1"},null,-1),r(" Tahun Ajaran ",-1)])],2)):o("",!0)])]),"date_range"===R.value?(t(),l(d,{key:0},[s("div",x,[s("div",w,[e[12]||(e[12]=s("label",{for:"start_date"},[s("i",{class:"fas fa-calendar-day mr-1"}),r(" Tanggal Mulai ")],-1)),c(s("input",{id:"start_date","onUpdate:modelValue":e[3]||(e[3]=a=>L.value.start_date=a),type:"date",class:"form-control"},null,512),[[i,L.value.start_date]])])]),s("div",T,[s("div",F,[e[13]||(e[13]=s("label",{for:"end_date"},[s("i",{class:"fas fa-calendar-day mr-1"}),r(" Tanggal Akhir ")],-1)),c(s("input",{id:"end_date","onUpdate:modelValue":e[4]||(e[4]=a=>L.value.end_date=a),type:"date",class:"form-control"},null,512),[[i,L.value.end_date]])])])],64)):o("",!0),"month"===R.value?(t(),l("div",U,[s("div",j,[e[14]||(e[14]=s("label",{for:"month"},[s("i",{class:"fas fa-calendar mr-1"}),r(" Pilih Bulan ")],-1)),c(s("input",{id:"month","onUpdate:modelValue":e[5]||(e[5]=a=>L.value.month=a),type:"month",class:"form-control"},null,512),[[i,L.value.month]])])])):o("",!0),"academic_year"===R.value&&p.showAcademicYearFilter?(t(),l("div",E,[u(b,{modelValue:L.value.academic_year_id,"onUpdate:modelValue":e[6]||(e[6]=a=>L.value.academic_year_id=a),label:"Tahun Ajaran",name:"academic_year_id",placeholder:"Pilih Tahun Ajaran",serverside:!0,endpoint:"academic-years","label-key":"name","value-key":"id"},null,8,["modelValue"])])):o("",!0),p.showTeacherFilter?(t(),l("div",V,[u(b,{modelValue:L.value.teacher_id,"onUpdate:modelValue":e[7]||(e[7]=a=>L.value.teacher_id=a),label:"Filter Guru (Opsional)",name:"teacher_id",placeholder:"Semua Guru",serverside:!0,endpoint:"users?filter[role_id]=2","label-key":"name","value-key":"id"},null,8,["modelValue"])])):o("",!0),s("div",{class:"col-md-12"},[s("button",{type:"button",class:"btn btn-navy shadow-sm",onClick:S},[...e[15]||(e[15]=[s("i",{class:"fas fa-search mr-2"},null,-1),r(" Tampilkan Laporan ",-1)])]),s("button",{type:"button",class:"btn btn-secondary ml-2",onClick:P},[...e[16]||(e[16]=[s("i",{class:"fas fa-redo mr-2"},null,-1),r(" Reset ",-1)])])])])])]))}},[["__scopeId","data-v-f26d7f56"]]),R={class:"export-buttons"},S=["disabled"],P=["disabled"],$=m({__name:"ExportButtons",props:{filters:{type:Object,default:()=>({})},reportType:{type:String,required:!0}},setup(a){const o=a,n=e(!1),d=async()=>{n.value=!0;try{const a=new URLSearchParams(o.filters).toString(),e=`https://adajago.com/api/v1/reports/${o.reportType}/export-pdf?${a}`,l=await fetch(e,{headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("token")).token}`}});if(!l.ok)return void v("Gagal export PDF: "+l.statusText);const t=await l.blob(),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`laporan-${o.reportType}-${Date.now()}.pdf`,r.click(),URL.revokeObjectURL(s),f("Export PDF berhasil!")}catch(a){v("Gagal export PDF: "+a.message)}finally{n.value=!1}},c=async()=>{n.value=!0;try{const a=new URLSearchParams(o.filters).toString(),e=`https://adajago.com/api/v1/reports/${o.reportType}/export-excel?${a}`,l=await fetch(e,{headers:{Authorization:`Bearer ${JSON.parse(localStorage.getItem("token")).token}`}}),t=await l.blob(),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`laporan-${o.reportType}-${Date.now()}.xlsx`,r.click(),URL.revokeObjectURL(s)}catch(a){v("Gagal export Excel: "+a.message)}finally{n.value=!1,f("Export Excel berhasil!")}};return(a,e)=>(t(),l("div",R,[s("button",{type:"button",class:"btn btn-danger shadow-sm",disabled:n.value,onClick:d},[e[0]||(e[0]=s("i",{class:"fas fa-file-pdf mr-2"},null,-1)),r(" "+p(n.value?"Exporting...":"Export PDF"),1)],8,S),s("button",{type:"button",class:"btn btn-success shadow-sm ml-2",disabled:n.value,onClick:c},[e[1]||(e[1]=s("i",{class:"fas fa-file-excel mr-2"},null,-1)),r(" "+p(n.value?"Exporting...":"Export Excel"),1)],8,P)]))}},[["__scopeId","data-v-dabaf60e"]]);export{$ as E,L as F};
