import{a,B as l,l as e,f as s,y as o,m as i,u as n,t,g as r,i as d,p as c,h as p,q as u,v as m,n as v,F as f,o as b}from"./vue-CzxLGHcz.js";import{u as h,a as y,b as g,e as w}from"./app-BZL2lnh6.js";import k from"./FileUpload-Dl9LQJ9W.js";const x={class:"content"},j={class:"container-fluid"},P={class:"row"},U={class:"col-md-4"},V={class:"card card-outline card-navy shadow-sm"},_={class:"card-body box-profile"},E={class:"text-center"},T=["src"],C={class:"profile-username text-center"},F={class:"text-muted text-center"},N={class:"list-group list-group-unbordered mb-3"},S={class:"list-group-item"},q={class:"float-right"},B={key:0,class:"list-group-item"},I={class:"float-right"},O={key:1,class:"list-group-item"},A={class:"float-right"},G={class:"col-md-8"},H={class:"card card-outline card-navy shadow-sm"},K={class:"card-body"},D={class:"row"},L={class:"col-md-6"},M={class:"form-group"},R={key:0,class:"invalid-feedback"},z={class:"col-md-6"},J={class:"form-group"},Q={key:0,class:"invalid-feedback"},W={class:"row"},X={class:"col-md-6"},Y={class:"form-group"},Z={key:0,class:"invalid-feedback"},$={class:"col-md-6"},aa={class:"form-group"},la={key:0,class:"invalid-feedback"},ea={class:"row"},sa={class:"col-md-6"},oa={class:"form-group"},ia={key:0,class:"invalid-feedback"},na={class:"col-md-6"},ta={class:"form-group"},ra={class:"card-footer"},da=["disabled"],ca=["disabled"],pa={__name:"index",setup(pa){const{user:ua,setUser:ma}=h(),va=a(!1),fa=a({}),ba=l({name:"",email:"",nip:"",phone:"",password:"",password_confirmation:"",photo:null});async function ha(){try{const{ok:a,data:l}=await y("me");if(a){const a=l.data.user;Object.assign(ba,{name:a.name||"",email:a.email||"",nip:a.nip||"",phone:a.phone||"",photo:a.photo||null})}}catch(a){await g("Gagal memuat data profile")}}async function ya(){va.value=!0,fa.value={};try{const{type:a,body:l}=function(a){if(!(a.photo instanceof File)){const{photo:l,...e}=a;return{type:"json",body:{...e}}}const l=new FormData;return Object.keys(a).forEach(e=>{"password_confirmation"!==e&&null!==a[e]&&l.append(e,a[e])}),l.append("_method","PATCH"),{type:"formdata",body:l}}(ba),{ok:e,data:s,error:o}=await y("me",{method:"json"===a?"PATCH":"POST",body:l,headers:"json"===a?{}:{"Content-Type":"multipart/form-data"}});e?(await w("Profile berhasil diperbarui"),window.location.reload()):o&&"object"==typeof o?fa.value=o:await g(o||"Gagal memperbarui profile")}catch(a){await g("Terjadi kesalahan saat memperbarui profile")}finally{va.value=!1}}function ga(){ha(),fa.value={}}return e(()=>{ha()}),(a,l)=>{var e,h,y,g,w,pa,ma,ha,wa;return b(),s(f,null,[l[24]||(l[24]=o('<div class="content-header"><div class="container-fluid"><div class="row mb-2"><div class="col-sm-6"><h1 class="m-0 font-serif-formal">Profile Saya</h1></div></div></div></div>',1)),i("section",x,[i("div",j,[i("div",P,[i("div",U,[i("div",V,[i("div",_,[i("div",E,[i("img",{src:(null==(e=n(ua).user)?void 0:e.photo)||"/assets/images/avatar5.png",class:"profile-user-img img-fluid img-circle",alt:"User Profile Picture",style:{width:"100px",height:"100px","object-fit":"cover"}},null,8,T)]),i("h3",C,t(null==(h=n(ua).user)?void 0:h.name),1),i("p",F,t(null==(g=null==(y=n(ua).user)?void 0:y.role)?void 0:g.label),1),i("ul",N,[i("li",S,[l[8]||(l[8]=i("b",null,"Email",-1)),l[9]||(l[9]=d()),i("a",q,t(null==(w=n(ua).user)?void 0:w.email),1)]),(null==(pa=n(ua).user)?void 0:pa.nip)?(b(),s("li",B,[l[10]||(l[10]=i("b",null,"NIP",-1)),l[11]||(l[11]=d()),i("a",I,t(null==(ma=n(ua).user)?void 0:ma.nip),1)])):r("",!0),(null==(ha=n(ua).user)?void 0:ha.phone)?(b(),s("li",O,[l[12]||(l[12]=i("b",null,"Telepon",-1)),l[13]||(l[13]=d()),i("a",A,t(null==(wa=n(ua).user)?void 0:wa.phone),1)])):r("",!0)])])])]),i("div",G,[i("div",H,[l[23]||(l[23]=i("div",{class:"card-header border-bottom-0"},[i("h3",{class:"card-title font-serif-formal"},"Edit Profile")],-1)),i("form",{onSubmit:c(ya,["prevent"])},[i("div",K,[i("div",D,[i("div",L,[i("div",M,[l[14]||(l[14]=i("label",{for:"name"},[d("Nama Lengkap "),i("span",{class:"text-danger"},"*")],-1)),u(i("input",{type:"text",class:v(["form-control",{"is-invalid":fa.value.name}]),id:"name","onUpdate:modelValue":l[0]||(l[0]=a=>ba.name=a),required:""},null,2),[[m,ba.name]]),fa.value.name?(b(),s("div",R,t(fa.value.name[0]),1)):r("",!0)])]),i("div",z,[i("div",J,[l[15]||(l[15]=i("label",{for:"email"},[d("Email "),i("span",{class:"text-danger"},"*")],-1)),u(i("input",{type:"email",class:v(["form-control",{"is-invalid":fa.value.email}]),id:"email","onUpdate:modelValue":l[1]||(l[1]=a=>ba.email=a),onInput:l[2]||(l[2]=(...l)=>a.preventEmailChange&&a.preventEmailChange(...l)),required:""},null,34),[[m,ba.email]]),l[16]||(l[16]=i("small",{class:"form-text text-muted"},"Email tidak dapat diubah",-1)),fa.value.email?(b(),s("div",Q,t(fa.value.email[0]),1)):r("",!0)])])]),i("div",W,[i("div",X,[i("div",Y,[l[17]||(l[17]=i("label",{for:"nip"},"NIP",-1)),u(i("input",{type:"text",class:v(["form-control",{"is-invalid":fa.value.nip}]),id:"nip",disabled:"","onUpdate:modelValue":l[3]||(l[3]=a=>ba.nip=a)},null,2),[[m,ba.nip]]),fa.value.nip?(b(),s("div",Z,t(fa.value.nip[0]),1)):r("",!0)])]),i("div",$,[i("div",aa,[l[18]||(l[18]=i("label",{for:"phone"},"No. Telepon",-1)),u(i("input",{type:"tel",class:v(["form-control",{"is-invalid":fa.value.phone}]),id:"phone","onUpdate:modelValue":l[4]||(l[4]=a=>ba.phone=a)},null,2),[[m,ba.phone]]),fa.value.phone?(b(),s("div",la,t(fa.value.phone[0]),1)):r("",!0)])])]),i("div",ea,[i("div",sa,[i("div",oa,[l[19]||(l[19]=i("label",{for:"password"},"Password Baru",-1)),u(i("input",{type:"password",class:v(["form-control",{"is-invalid":fa.value.password}]),id:"password","onUpdate:modelValue":l[5]||(l[5]=a=>ba.password=a),placeholder:"Kosongkan jika tidak ingin mengubah password"},null,2),[[m,ba.password]]),fa.value.password?(b(),s("div",ia,t(fa.value.password[0]),1)):r("",!0)])]),i("div",na,[i("div",ta,[l[20]||(l[20]=i("label",{for:"password_confirmation"},"Konfirmasi Password Baru",-1)),u(i("input",{type:"password",class:"form-control",id:"password_confirmation","onUpdate:modelValue":l[6]||(l[6]=a=>ba.password_confirmation=a),placeholder:"Ulangi password baru"},null,512),[[m,ba.password_confirmation]])])])]),p(k,{modelValue:ba.photo,"onUpdate:modelValue":l[7]||(l[7]=a=>ba.photo=a),label:"Foto Profile",accept:"jpeg,jpg,png",class:"mt-3"},null,8,["modelValue"])]),i("div",ra,[i("button",{type:"submit",class:"btn btn-primary",disabled:va.value},[l[21]||(l[21]=i("i",{class:"fas fa-save mr-1"},null,-1)),d(" "+t(va.value?"Menyimpan...":"Simpan Perubahan"),1)],8,da),i("button",{type:"button",class:"btn btn-default ml-2",onClick:ga,disabled:va.value},[...l[22]||(l[22]=[i("i",{class:"fas fa-undo mr-1"},null,-1),d(" Reset ",-1)])],8,ca)])],32)])])])])])],64)}}};export{pa as default};
