import{a,b as l,l as e,f as s,y as t,m as n,h as r,g as c,t as u,i,c as d,F as o,s as v,u as p,n as m,p as g,o as h}from"./vue-CzxLGHcz.js";import{_ as b,h as _,a as f,b as y}from"./app-CFGDmtZY.js";import{F as j,E as k}from"./ExportButtons-CPZ5T0vq.js";const x={class:"content"},w={class:"container-fluid"},T={key:0,class:"row mt-4"},E={class:"col-lg-3 col-6"},G={class:"small-box bg-info"},q={class:"inner"},J={class:"col-lg-3 col-6"},C={class:"small-box bg-success"},M={class:"inner"},O={class:"col-lg-3 col-6"},S={class:"small-box bg-warning"},D={class:"inner"},F={class:"col-lg-3 col-6"},I={class:"small-box bg-danger"},K={class:"inner"},L={class:"row mt-4"},P={class:"col-12"},V={class:"card card-outline card-navy shadow-sm"},N={class:"card-header"},Y={class:"card-tools"},A={class:"card-body table-responsive p-0"},B={key:0,class:"text-center p-5"},R={key:1,class:"table table-hover ledger-table text-nowrap"},U={class:"text-center"},z={class:"badge badge-info"},H={key:2,class:"text-center p-5"},Q={class:"text-muted"},W={key:0,class:"card-footer clearfix"},X={class:"pagination pagination-sm m-0 float-right"},Z=["onClick"],$=b({__name:"teacher-journals",setup(b){const $=a(!1),aa=a([]),la=a({total_journals:0,unique_teachers:0,unique_classes:0,total_subjects:0}),ea=a({start_date:"",end_date:"",month:"",academic_year_id:"",teacher_id:"",subject_id:"",class_id:""}),sa=a({current_page:1,per_page:15,total:0,last_page:1}),ta=async(a=1)=>{$.value=!0;try{const l={...ea.value,page:a,per_page:sa.value.per_page};Object.keys(l).forEach(a=>{l[a]||delete l[a]});const{ok:e,data:s,error:t}=await f("reports/teacher-journals",{method:"GET",params:l});e?(aa.value=s.data.journals.data||[],sa.value={current_page:s.data.journals.current_page,per_page:s.data.journals.per_page,total:s.data.journals.total,last_page:s.data.journals.last_page}):y(t)}catch(l){y(l.message)}finally{$.value=!1}},na=async()=>{try{const a={...ea.value};Object.keys(a).forEach(l=>{a[l]||delete a[l]});const{ok:l,data:e,error:s}=await f("reports/teacher-journals/summary",{method:"GET",params:a});l&&(la.value=e.data.summary)}catch(a){}},ra=async()=>{sa.value.current_page=1,await Promise.all([ta(1),na()])},ca=()=>{ea.value={start_date:"",end_date:"",month:"",academic_year_id:"",teacher_id:"",subject_id:"",class_id:""},aa.value=[],la.value={total_journals:0,unique_teachers:0,unique_classes:0,total_subjects:0}},ua=a=>{a>=1&&a<=sa.value.last_page&&ta(a)},ia=l(()=>aa.value.length>0),da=l(()=>Object.keys(ea.value).filter(a=>ea.value[a]).length>0);return e(()=>{const a=new Date,l=new Date(a.getFullYear(),a.getMonth(),1),e=new Date(a.getFullYear(),a.getMonth()+1,0);ea.value.start_date=l.toISOString().split("T")[0],ea.value.end_date=e.toISOString().split("T")[0],ra()}),(a,l)=>(h(),s(o,null,[l[16]||(l[16]=t('<section class="content-header" data-v-d608b806><div class="container-fluid" data-v-d608b806><div class="row" data-v-d608b806><div class="col-sm-6" data-v-d608b806><h4 class="font-serif-formal" data-v-d608b806>Laporan Jurnal Guru</h4></div><div class="col-sm-6" data-v-d608b806><ol class="breadcrumb float-sm-right" data-v-d608b806><li class="breadcrumb-item" data-v-d608b806><a href="#" data-v-d608b806>Laporan</a></li><li class="breadcrumb-item active" data-v-d608b806>Jurnal Guru</li></ol></div></div></div></section>',1)),n("section",x,[n("div",w,[r(j,{modelValue:ea.value,"onUpdate:modelValue":l[0]||(l[0]=a=>ea.value=a),onApply:ra,onReset:ca},null,8,["modelValue"]),ia.value?(h(),s("div",T,[n("div",E,[n("div",G,[n("div",q,[n("h3",null,u(la.value.total_journals),1),l[3]||(l[3]=n("p",null,"Total Jurnal",-1))]),l[4]||(l[4]=n("div",{class:"icon"},[n("i",{class:"fas fa-book"})],-1))])]),n("div",J,[n("div",C,[n("div",M,[n("h3",null,u(la.value.unique_teachers),1),l[5]||(l[5]=n("p",null,"Jumlah Guru",-1))]),l[6]||(l[6]=n("div",{class:"icon"},[n("i",{class:"fas fa-chalkboard-teacher"})],-1))])]),n("div",O,[n("div",S,[n("div",D,[n("h3",null,u(la.value.unique_classes),1),l[7]||(l[7]=n("p",null,"Jumlah Kelas",-1))]),l[8]||(l[8]=n("div",{class:"icon"},[n("i",{class:"fas fa-school"})],-1))])]),n("div",F,[n("div",I,[n("div",K,[n("h3",null,u(la.value.total_subjects),1),l[9]||(l[9]=n("p",null,"Mata Pelajaran",-1))]),l[10]||(l[10]=n("div",{class:"icon"},[n("i",{class:"fas fa-book-open"})],-1))])])])):c("",!0),n("div",L,[n("div",P,[n("div",V,[n("div",N,[l[11]||(l[11]=n("h3",{class:"card-title font-serif-formal"},[n("i",{class:"fas fa-table mr-2"}),i(" Data Jurnal Guru ")],-1)),n("div",Y,[ia.value?(h(),d(k,{key:0,filters:{...ea.value},"report-type":"teacher-journals"},null,8,["filters"])):c("",!0)])]),n("div",A,[$.value?(h(),s("div",B,[...l[12]||(l[12]=[n("i",{class:"fas fa-spinner fa-spin fa-3x text-navy"},null,-1),n("p",{class:"mt-3"},"Memuat data...",-1)])])):ia.value?(h(),s("table",R,[l[14]||(l[14]=n("thead",null,[n("tr",null,[n("th",{style:{width:"5%"}},"No"),n("th",null,"Tanggal"),n("th",null,"Nama Guru"),n("th",null,"Kelas"),n("th",null,"Mata Pelajaran"),n("th",null,"Tema"),n("th",null,"Kegiatan"),n("th",null,"Catatan")])],-1)),n("tbody",null,[(h(!0),s(o,null,v(aa.value,(a,e)=>{var t,r,c;return h(),s("tr",{key:a.id},[n("td",U,u((sa.value.current_page-1)*sa.value.per_page+e+1),1),n("td",null,[l[13]||(l[13]=n("i",{class:"fas fa-calendar-day mr-1 text-muted"},null,-1)),i(" "+u(p(_)(a.date)),1)]),n("td",null,[n("strong",null,u((null==(t=a.teacher)?void 0:t.name)||"-"),1)]),n("td",null,u((null==(r=a.classroom)?void 0:r.name)||"-"),1),n("td",null,[n("span",z,u((c=a,c.subjects&&0!==c.subjects.length?c.subjects.map(a=>{var l;return(null==(l=a.subject)?void 0:l.name)||"-"}).join(", "):"-")),1)]),n("td",null,u(a.theme||"-"),1),n("td",null,u(a.activity||"-"),1),n("td",null,u(a.note||"-"),1)])}),128))])])):(h(),s("div",H,[l[15]||(l[15]=n("i",{class:"fas fa-inbox fa-3x text-muted mb-3"},null,-1)),n("p",Q,u(da.value?"Tidak ada data untuk filter yang dipilih":'Silakan pilih filter dan klik "Tampilkan Laporan"'),1)]))]),ia.value&&sa.value.last_page>1?(h(),s("div",W,[n("ul",X,[n("li",{class:m(["page-item",{disabled:1===sa.value.current_page}])},[n("a",{class:"page-link",href:"#",onClick:l[1]||(l[1]=g(a=>ua(sa.value.current_page-1),["prevent"]))},"«")],2),(h(!0),s(o,null,v(sa.value.last_page,a=>(h(),s("li",{key:a,class:m(["page-item",{active:sa.value.current_page===a}])},[n("a",{class:"page-link",href:"#",onClick:g(l=>ua(a),["prevent"])},u(a),9,Z)],2))),128)),n("li",{class:m(["page-item",{disabled:sa.value.current_page===sa.value.last_page}])},[n("a",{class:"page-link",href:"#",onClick:l[2]||(l[2]=g(a=>ua(sa.value.current_page+1),["prevent"]))},"»")],2)])])):c("",!0)])])])])])],64))}},[["__scopeId","data-v-d608b806"]]);export{$ as default};
