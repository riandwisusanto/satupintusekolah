import{b as e,p as a,w as l,r as t,c as s,o as d,q as i,s as n,a as r,f as o,m as u,h as c,g as m,x as v,j as p,i as b,t as f,F as y}from"./vue-DNxxE8NJ.js";import{c as _,g,f as h,a as V,d as j,b as w}from"./app-BXNMZXLM.js";import T from"./SelectServerSide-DMG6mAt7.js";const S={__name:"form",props:{selected:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible","save"],setup(r,{expose:o,emit:u}){const c=r,m=u,v=e({get:()=>c.visible,set:e=>m("update:visible",e)});const p=a({id:null,name:"",start_date:"",end_date:"",active:!0});function b(){Object.assign(p,{id:null,name:"",start_date:"",end_date:"",active:!0})}function f(){m("save",{...p})}return l(()=>c.visible,e=>{var a;e&&c.selected?(a=c.selected)&&Object.assign(p,{...a,active:1==a.active}):e||b()}),o({close:function(){m("update:visible",!1),b()}}),(e,a)=>{const l=t("FormInput"),o=t("FormToggleStatus"),u=t("FormDrawer");return d(),s(u,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=e=>v.value=e),title:r.selected?"Ubah Tahun Ajaran":"Tambah Tahun Ajaran",width:"500",onSave:f},{default:i(()=>[n(l,{modelValue:p.name,"onUpdate:modelValue":a[0]||(a[0]=e=>p.name=e),label:"Nama Tahun Ajaran",required:""},null,8,["modelValue"]),n(T,{label:"Semester",modelValue:p.semester,"onUpdate:modelValue":a[1]||(a[1]=e=>p.semester=e),options:[{label:"Ganjil",value:1},{label:"Genap",value:2}],serverside:!1,required:""},null,8,["modelValue"]),n(l,{modelValue:p.start_date,"onUpdate:modelValue":a[2]||(a[2]=e=>p.start_date=e),label:"Tanggal Mulai",type:"date",required:""},null,8,["modelValue"]),n(l,{modelValue:p.end_date,"onUpdate:modelValue":a[3]||(a[3]=e=>p.end_date=e),label:"Tanggal Selesai",type:"date",required:""},null,8,["modelValue"]),n(o,{modelValue:p.active,"onUpdate:modelValue":a[4]||(a[4]=e=>p.active=e)},null,8,["modelValue"])]),_:1},8,["modelValue","title"])}}},k={class:"content"},A={class:"btn-group"},U=["onClick"],x=["onClick"],C={__name:"index",setup(e){const a=r(),{checkPermission:l}=_(),s=r(!1),T=r(null),C=r(!1),q={true:{text:"Aktif",class:"badge-success"},false:{text:"Tidak Aktif",class:"badge-danger"}},D=[{field:"id",display:"#ID"},{field:"name",display:"Nama Tahun Ajaran"},{field:"semester",display:"Semester",component:e=>e.semester%2?"Genap":"Ganjil"},{field:"start_date",display:"Tanggal Mulai"},{field:"end_date",display:"Tanggal Selesai"},{field:"active",display:"Status"},{field:"action",display:"Action",sortable:!1}],F=()=>{T.value=null,s.value=!0},G=async e=>{h("save").then(async l=>{var t;if(l.isConfirmed){C.value=!0;let l="academic-years";e.id&&(l=`academic-years/${e.id}`);const{ok:d,data:i,error:n}=await V(l,{method:e.id?"put":"post",body:e});d?(j(i.message),s.value=!1,null==(t=a.value)||t.reload()):w(n),C.value=!1}})};return(e,r)=>{const _=t("StatusTag"),O=t("TableServerSide");return d(),o(y,null,[r[3]||(r[3]=u('<section class="content-header"><div class="container-fluid"><div class="row"><div class="col-sm-6"><h4 class="font-serif-formal">Data Tahun Ajaran</h4></div><div class="col-sm-6"><ol class="breadcrumb float-sm-right"><li class="breadcrumb-item"><a href="#">Master</a></li><li class="breadcrumb-item active">Data Tahun Ajaran</li></ol></div></div></div></section>',1)),c("section",k,[n(O,{ref_key:"tableRef",ref:a,title:"","show-add-button":v(l)("master_data.academic_years.create"),"show-drawer":!0,columns:D,"initial-sort":{field:"id",order:"desc"},per_page:10,endpoint:"academic-years",loading:C.value,onOpenDrawer:F},{"cell-start_date":i(({row:e})=>[b(f(v(g)(e.start_date)),1)]),"cell-end_date":i(({row:e})=>[b(f(v(g)(e.end_date)),1)]),"cell-active":i(({row:e})=>[n(_,{status:e.active,map:q},null,8,["status"])]),"cell-action":i(({row:e})=>[c("div",A,[v(l)("master_data.academic_years.update")&&1==e.editable?(d(),o("button",{key:0,class:"btn btn-primary btn-sm",type:"button",onClick:p(a=>(e=>{T.value=e,s.value=!0})(e),["stop","prevent"])},[...r[1]||(r[1]=[c("i",{class:"fas fa-edit"},null,-1)])],8,U)):m("",!0),v(l)("master_data.academic_years.delete")&&1==e.deletable?(d(),o("button",{key:1,class:"btn btn-danger btn-sm",type:"button",onClick:p(l=>(async e=>{h("delete").then(async l=>{var t;if(l.isConfirmed){const{ok:l,data:s,error:d}=await V(`academic-years/${e}`,{method:"delete"});l?(j(s.message),null==(t=a.value)||t.reload()):w(d)}})})(e.id),["stop","prevent"])},[...r[2]||(r[2]=[c("i",{class:"fas fa-trash"},null,-1)])],8,x)):m("",!0)])]),_:1},8,["show-add-button","loading"])]),n(S,{visible:s.value,"onUpdate:visible":r[0]||(r[0]=e=>s.value=e),selected:T.value,onSave:G},null,8,["visible","selected"])],64)}}};export{C as default};
