import{a,b as e,l,f as s,y as t,m as c,h as n,g as r,t as i,i as d,c as u,F as o,s as v,u as p,n as g,p as m,o as _}from"./vue-CzxLGHcz.js";import{_ as b,h,i as f,a as y,b as k}from"./app-CFGDmtZY.js";import{F as x,E as w}from"./ExportButtons-CPZ5T0vq.js";const T={class:"content"},S={class:"container-fluid"},E={key:0,class:"row mt-4"},j={class:"col-lg-3 col-6"},C={class:"small-box bg-info"},G={class:"inner"},I={class:"col-lg-3 col-6"},M={class:"small-box bg-success"},O={class:"inner"},A={class:"col-lg-3 col-6"},D={class:"small-box bg-warning"},F={class:"inner"},L={class:"col-lg-3 col-6"},N={class:"small-box bg-danger"},P={class:"inner"},V={class:"row mt-4"},q={class:"col-12"},H={class:"card card-outline card-navy shadow-sm"},R={class:"card-header"},W={class:"card-tools"},Y={class:"card-body table-responsive p-0"},z={key:0,class:"text-center p-5"},B={key:1,class:"table table-hover ledger-table text-nowrap"},K={class:"text-center"},U={class:"text-center"},J={class:"text-center"},Q={class:"text-center"},X={key:2,class:"text-center p-5"},Z={class:"text-muted"},$={key:0,class:"card-footer clearfix"},aa={class:"pagination pagination-sm m-0 float-right"},ea=["onClick"],la=b({__name:"teacher-attendance",setup(b){const la=a(!1),sa=a([]),ta=a({total_records:0,unique_teachers:0,present_days:0,absent_days:0,sick_days:0,permission_days:0,leave_days:0,attendance_percentage:0}),ca=a({start_date:"",end_date:"",month:"",academic_year_id:"",teacher_id:""}),na=a({current_page:1,per_page:15,total:0,last_page:1}),ra=async(a=1)=>{la.value=!0;try{const e={...ca.value,page:a,per_page:na.value.per_page};Object.keys(e).forEach(a=>{e[a]||delete e[a]});const{ok:l,data:s,error:t}=await y("reports/teacher-attendance",{method:"GET",params:e});l?(sa.value=s.data.attendances.data||[],na.value={current_page:s.data.attendances.current_page,per_page:s.data.attendances.per_page,total:s.data.attendances.total,last_page:s.data.attendances.last_page}):k(t)}catch(e){k(e.message)}finally{la.value=!1}},ia=async()=>{try{const a={...ca.value};Object.keys(a).forEach(e=>{a[e]||delete a[e]});const{ok:e,data:l,error:s}=await y("reports/teacher-attendance/summary",{method:"GET",params:a});e&&(ta.value=l.data.summary)}catch(a){}},da=async()=>{na.value.current_page=1,await Promise.all([ra(1),ia()])},ua=()=>{ca.value={start_date:"",end_date:"",month:"",academic_year_id:"",teacher_id:""},sa.value=[],ta.value={total_records:0,unique_teachers:0,present_days:0,absent_days:0,sick_days:0,permission_days:0,leave_days:0,attendance_percentage:0}},oa=a=>{a>=1&&a<=na.value.last_page&&ra(a)},va=a=>({check_in:{label:"Masuk",class:"badge-success"},check_out:{label:"Pulang",class:"badge-success"},sick:{label:"Sakit",class:"badge-warning"},permission:{label:"Izin",class:"badge-info"},on_leave:{label:"Cuti",class:"badge-secondary"}}[a]||{label:a,class:"badge-secondary"}),pa=e(()=>sa.value.length>0),ga=e(()=>Object.keys(ca.value).filter(a=>ca.value[a]).length>0);return l(()=>{const a=new Date,e=new Date(a.getFullYear(),a.getMonth(),1),l=new Date(a.getFullYear(),a.getMonth()+1,0);ca.value.start_date=e.toISOString().split("T")[0],ca.value.end_date=l.toISOString().split("T")[0],da()}),(a,e)=>(_(),s(o,null,[e[16]||(e[16]=t('<section class="content-header" data-v-be042a29><div class="container-fluid" data-v-be042a29><div class="row" data-v-be042a29><div class="col-sm-6" data-v-be042a29><h4 class="font-serif-formal" data-v-be042a29>Laporan Absensi Guru</h4></div><div class="col-sm-6" data-v-be042a29><ol class="breadcrumb float-sm-right" data-v-be042a29><li class="breadcrumb-item" data-v-be042a29><a href="#" data-v-be042a29>Laporan</a></li><li class="breadcrumb-item active" data-v-be042a29>Absensi Guru</li></ol></div></div></div></section>',1)),c("section",T,[c("div",S,[n(x,{modelValue:ca.value,"onUpdate:modelValue":e[0]||(e[0]=a=>ca.value=a),onApply:da,onReset:ua},null,8,["modelValue"]),pa.value?(_(),s("div",E,[c("div",j,[c("div",C,[c("div",G,[c("h3",null,i(ta.value.total_records),1),e[3]||(e[3]=c("p",null,"Total Record",-1))]),e[4]||(e[4]=c("div",{class:"icon"},[c("i",{class:"fas fa-clipboard-list"})],-1))])]),c("div",I,[c("div",M,[c("div",O,[c("h3",null,i(ta.value.present_days),1),e[5]||(e[5]=c("p",null,"Hadir",-1))]),e[6]||(e[6]=c("div",{class:"icon"},[c("i",{class:"fas fa-check-circle"})],-1))])]),c("div",A,[c("div",D,[c("div",F,[c("h3",null,i(ta.value.sick_days),1),e[7]||(e[7]=c("p",null,"Sakit",-1))]),e[8]||(e[8]=c("div",{class:"icon"},[c("i",{class:"fas fa-thermometer-half"})],-1))])]),c("div",L,[c("div",N,[c("div",P,[c("h3",null,i(ta.value.absent_days),1),e[9]||(e[9]=c("p",null,"Tidak Hadir",-1))]),e[10]||(e[10]=c("div",{class:"icon"},[c("i",{class:"fas fa-times-circle"})],-1))])])])):r("",!0),c("div",V,[c("div",q,[c("div",H,[c("div",R,[e[11]||(e[11]=c("h3",{class:"card-title font-serif-formal"},[c("i",{class:"fas fa-table mr-2"}),d(" Data Absensi Guru ")],-1)),c("div",W,[pa.value?(_(),u(w,{key:0,filters:ca.value,"report-type":"teacher-attendance"},null,8,["filters"])):r("",!0)])]),c("div",Y,[la.value?(_(),s("div",z,[...e[12]||(e[12]=[c("i",{class:"fas fa-spinner fa-spin fa-3x text-navy"},null,-1),c("p",{class:"mt-3"},"Memuat data...",-1)])])):pa.value?(_(),s("table",B,[e[14]||(e[14]=c("thead",null,[c("tr",null,[c("th",{style:{width:"5%"}},"No"),c("th",null,"Tanggal"),c("th",null,"Nama Guru"),c("th",null,"NIP"),c("th",null,"Waktu Masuk"),c("th",null,"Waktu Keluar"),c("th",null,"Status"),c("th",null,"Catatan")])],-1)),c("tbody",null,[(_(!0),s(o,null,v(sa.value,(a,l)=>{var t,n;return _(),s("tr",{key:a.id},[c("td",K,i((na.value.current_page-1)*na.value.per_page+l+1),1),c("td",null,[e[13]||(e[13]=c("i",{class:"fas fa-calendar-day mr-1 text-muted"},null,-1)),d(" "+i(p(h)(a.date)),1)]),c("td",null,[c("strong",null,i((null==(t=a.teacher)?void 0:t.name)||"-"),1)]),c("td",null,i((null==(n=a.teacher)?void 0:n.nip)||"-"),1),c("td",U,i(a.time_in?p(f)(a.time_in):"-"),1),c("td",J,i(a.time_out?p(f)(a.time_out):"-"),1),c("td",Q,[c("span",{class:g(["badge",va(a.status).class])},i(va(a.status).label),3)]),c("td",null,i(a.note||"-"),1)])}),128))])])):(_(),s("div",X,[e[15]||(e[15]=c("i",{class:"fas fa-inbox fa-3x text-muted mb-3"},null,-1)),c("p",Z,i(ga.value?"Tidak ada data untuk filter yang dipilih":'Silakan pilih filter dan klik "Tampilkan Laporan"'),1)]))]),pa.value&&na.value.last_page>1?(_(),s("div",$,[c("ul",aa,[c("li",{class:g(["page-item",{disabled:1===na.value.current_page}])},[c("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=m(a=>oa(na.value.current_page-1),["prevent"]))},"«")],2),(_(!0),s(o,null,v(na.value.last_page,a=>(_(),s("li",{key:a,class:g(["page-item",{active:na.value.current_page===a}])},[c("a",{class:"page-link",href:"#",onClick:m(e=>oa(a),["prevent"])},i(a),9,ea)],2))),128)),c("li",{class:g(["page-item",{disabled:na.value.current_page===na.value.last_page}])},[c("a",{class:"page-link",href:"#",onClick:e[2]||(e[2]=m(a=>oa(na.value.current_page+1),["prevent"]))},"»")],2)])])):r("",!0)])])])])])],64))}},[["__scopeId","data-v-be042a29"]]);export{la as default};
