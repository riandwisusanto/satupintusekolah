import{a,b as e,f as s,y as l,m as t,i,p as n,h as d,q as r,v as c,F as o,s as u,n as f,t as v,j as m,g as h,u as b,r as p,o as g}from"./vue-CzxLGHcz.js";import{_ as k,h as y,b as w,g as _,a as S,e as T}from"./app-BZL2lnh6.js";import C from"./FormSelectTeacher-DdbyZupL.js";const x={class:"content"},D={class:"container-fluid"},G={class:"row"},K={class:"col-md-12"},j={class:"card card-outline card-navy shadow-sm"},V={class:"card-body"},$={class:"row"},I={class:"col-md-6"},P={class:"col-md-6"},U={class:"form-group"},q={class:"col-md-12"},E={class:"form-group"},L={class:"status-options"},M=["onClick"],O={class:"status-label"},A={class:"col-md-12"},F={class:"form-group"},H={class:"col-md-12"},J=["disabled"],R=["disabled"],z={class:"row mt-4"},N={class:"col-md-12"},B={class:"teacher-info"},Q=["src"],W={class:"font-weight-bold"},X=["innerHTML"],Y={class:"text-muted"},Z=["onClick"],aa=k({__name:"absence",setup(k){const aa=a(!1),ea=a(null),sa=a({teacher_id:"",date:(new Date).toISOString().split("T")[0],status:"sick",notes:""}),la=[{value:"sick",label:"Sakit",icon:"fas fa-thermometer-half",color:"warning"},{value:"permission",label:"Izin",icon:"fas fa-file-signature",color:"info"},{value:"on_leave",label:"Cuti",icon:"fas fa-calendar-times",color:"secondary"}],ta=[{field:"date",display:"Tanggal"},{field:"teacher.name",display:"Nama Guru"},{field:"status",display:"Jenis Ketidakhadiran"},{field:"note",display:"Catatan"},{field:"action",display:"Aksi",sortable:!1}];e(()=>la.find(a=>a.value===sa.value.status));const ia=()=>{sa.value={teacher_id:"",date:(new Date).toISOString().split("T")[0],status:"sick",notes:""}},na=async()=>{sa.value.teacher_id?sa.value.date?_("save").then(async a=>{a.isConfirmed&&await da()}):w("Silakan pilih tanggal"):w("Silakan pilih guru")},da=async()=>{var a;aa.value=!0;try{const{ok:e,data:s,error:l}=await S("teacher-attendances/sick-leave",{method:"POST",body:sa.value});e?(T("Data ketidakhadiran berhasil dicatat"),ia(),null==(a=ea.value)||a.reload()):w(l)}catch(e){w(e.message)}finally{aa.value=!1}},ra=a=>{const e=la.find(e=>e.value===a);return e?`<span class="badge badge-${e.color}"><i class="${e.icon} mr-1"></i>${e.label}</span>`:'<span class="badge badge-secondary">Unknown</span>'};return(a,e)=>{const k=p("TableServerSide");return g(),s(o,null,[e[11]||(e[11]=l('<section class="content-header" data-v-a8f20f87><div class="container-fluid" data-v-a8f20f87><div class="row" data-v-a8f20f87><div class="col-sm-6" data-v-a8f20f87><h4 class="font-serif-formal" data-v-a8f20f87>Ketidakhadiran Guru</h4></div><div class="col-sm-6" data-v-a8f20f87><ol class="breadcrumb float-sm-right" data-v-a8f20f87><li class="breadcrumb-item" data-v-a8f20f87><a href="#" data-v-a8f20f87>Absensi</a></li><li class="breadcrumb-item active" data-v-a8f20f87>Ketidakhadiran Guru</li></ol></div></div></div></section>',1)),t("section",x,[t("div",D,[t("div",G,[t("div",K,[t("div",j,[e[8]||(e[8]=t("div",{class:"card-header border-bottom-0"},[t("h3",{class:"card-title font-serif-formal"},[t("i",{class:"fas fa-user-times mr-2"}),i(" Catat Ketidakhadiran Guru ")])],-1)),t("div",V,[t("form",{onSubmit:n(na,["prevent"])},[t("div",$,[t("div",I,[d(C,{modelValue:sa.value.teacher_id,"onUpdate:modelValue":e[0]||(e[0]=a=>sa.value.teacher_id=a),label:"Pilih Guru",name:"teacher_id",placeholder:"-- Pilih Guru --",required:!0},null,8,["modelValue"])]),t("div",P,[t("div",U,[e[3]||(e[3]=t("label",{for:"date"},[t("i",{class:"fas fa-calendar mr-1"}),i(" Tanggal "),t("span",{class:"text-danger"},"*")],-1)),r(t("input",{id:"date","onUpdate:modelValue":e[1]||(e[1]=a=>sa.value.date=a),type:"date",class:"form-control",required:""},null,512),[[c,sa.value.date]])])]),t("div",q,[t("div",E,[e[4]||(e[4]=t("label",null,[t("i",{class:"fas fa-clipboard-list mr-1"}),i(" Jenis Ketidakhadiran "),t("span",{class:"text-danger"},"*")],-1)),t("div",L,[(g(),s(o,null,u(la,a=>t("div",{key:a.value,class:f(["status-option",{active:sa.value.status===a.value}]),onClick:e=>sa.value.status=a.value},[t("div",{class:f(["status-icon",`bg-${a.color}`])},[t("i",{class:f(a.icon)},null,2)],2),t("div",O,v(a.label),1)],10,M)),64))])])]),t("div",A,[t("div",F,[e[5]||(e[5]=t("label",{for:"notes"},[t("i",{class:"fas fa-sticky-note mr-1"}),i(" Catatan / Keterangan ")],-1)),r(t("textarea",{id:"notes","onUpdate:modelValue":e[2]||(e[2]=a=>sa.value.notes=a),class:"form-control",rows:"3",placeholder:"Tambahkan catatan atau keterangan tambahan..."},null,512),[[c,sa.value.notes]])])]),t("div",H,[t("button",{type:"submit",class:"btn btn-navy btn-lg shadow-sm",disabled:aa.value},[e[6]||(e[6]=t("i",{class:"fas fa-save mr-2"},null,-1)),i(" "+v(aa.value?"Menyimpan...":"Simpan Data"),1)],8,J),t("button",{type:"button",class:"btn btn-secondary btn-lg ml-2",onClick:ia,disabled:aa.value},[...e[7]||(e[7]=[t("i",{class:"fas fa-redo mr-2"},null,-1),i(" Reset ",-1)])],8,R)])])],32)])])])]),t("div",z,[t("div",N,[d(k,{ref_key:"tableRef",ref:ea,title:"Daftar Ketidakhadiran Guru","show-add-button":!1,columns:ta,"initial-sort":{field:"date",order:"desc"},per_page:10,endpoint:"teacher-attendances",extra:{"filter[status][ne]":"check_in","filter[status][ne]":"check_out"}},{"cell-date":m(({row:a})=>[e[9]||(e[9]=t("i",{class:"fas fa-calendar-day mr-1 text-muted"},null,-1)),i(" "+v(b(y)(a.date)),1)]),"cell-teacher.name":m(({row:a})=>{var e,l;return[t("div",B,[(null==(e=a.teacher)?void 0:e.photo)?(g(),s("img",{key:0,src:a.teacher.photo,alt:"Teacher Photo",class:"rounded-circle mr-2",style:{width:"32px",height:"32px","object-fit":"cover"}},null,8,Q)):h("",!0),t("span",W,v((null==(l=a.teacher)?void 0:l.name)||"-"),1)])]}),"cell-status":m(({row:a})=>[t("span",{innerHTML:ra(a.status)},null,8,X)]),"cell-note":m(({row:a})=>[t("span",Y,v(a.note||"-"),1)]),"cell-action":m(({row:a})=>[a.deleteable?(g(),s("button",{key:0,class:"btn btn-danger btn-sm",type:"button",onClick:n(e=>(async a=>{_("delete").then(async e=>{var s;if(e.isConfirmed){const{ok:e,data:l,error:t}=await S(`teacher-attendances/${a}`,{method:"DELETE"});e?(T("Data berhasil dihapus"),null==(s=ea.value)||s.reload()):w(t)}})})(a.id),["stop","prevent"])},[...e[10]||(e[10]=[t("i",{class:"fas fa-trash"},null,-1)])],8,Z)):h("",!0)]),_:1},512)])])])])],64)}}},[["__scopeId","data-v-a8f20f87"]]);export{aa as default};
